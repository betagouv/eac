<app>
  <header class=block>
    <a href="/">
      <img id=logo src=/images/logo-eac.gif alt="Logo de la Plateforme EAC">
      <h1>Plateforme EAC</h1>
      <h2>L'Éducation artistique et culturelle à portée de main</h2>
    </a>
  </header>

  <section class=block if={ this.schoolId }>
    <school-card school-id={ this.schoolId } />
  </section>

  <main ref=container></main>


  <script>
    /* globals page, riot */
    page('/', () => {
      this.schoolId = ''
      this.refs.container.innerHTML = `<page-school></page-school>`
      riot.mount('page-school')
      this.update()
    })

    page('/school/:school/search', (ctx) => {
      this.schoolId = ctx.params.school
      this.refs.container.innerHTML = `<page-search school-id="${this.schoolId}" />`
      riot.mount('page-search')
      this.update()
    })

    page('/school/:school/search/:q/:filters', (ctx) => {
      this.schoolId = ctx.params.school
      this.refs.container.innerHTML = `<page-search
        school-id="${this.schoolId}"
        q="${ctx.params.q}"
        filters="${encodeURI(ctx.params.filters)}"
        />`
      riot.mount('page-search')
      this.update()
    })

    page('/school/:school/actor/:id', (ctx) => {
      this.schoolId = ctx.params.school
      this.refs.container.innerHTML = `<page-actor
        school-id="${this.schoolId}"
        actor-id="${ctx.params.id}"
        />`
      riot.mount('page-actor')
      this.update()
    })

    this.on('mount', () => {
      page()
      document.body.classList.add('ready')
    })
  </script>


  <style scoped>
    header {
      display: grid;
      grid-template:
        ". logo title ."
        ". logo baseline ."
        / 1fr 150px auto 1fr
        ;
      border-bottom: 5px solid;
      border-image: linear-gradient(
        to right, 
        #4f2559 calc(100%/6), 
        #ea8323 calc(100%/6), 
        #ea8323 calc((100%/6)*2),
        #7d932d calc((100%/6)*2), 
        #7d932d calc((100%/6)*3), 
        #209fd6 calc((100%/6)*3), 
        #209fd6 calc((100%/6)*4), 
        #f7da34 calc((100%/6)*4), 
        #f7da34 calc((100%/6)*5), 
        #dd0e29 75%
      ) 5;
    }
    header > a {
      display: contents;
      color: inherit;
    }
    header > a #logo {
      grid-area: logo;
    }
    header > a h1 {
      grid-area: title;
      font-size: 2em;
      margin: .4em 0 0 1rem;
      align-self: end;
    }
    header > a h2 {
      grid-area: baseline;
      font-size: 1em;
      font-weight: 200;
      margin-left: 1rem;
    }
  </style>
</app>
