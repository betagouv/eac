<action-card>
  <h3>{ action.Nom }</h3>
  <p>{ this.actor.Description.length < this.maxlength ? this.actor.Description : this.actor.Description.substr(0, this.maxlength) + 'â€¦' }</p>
  <nav class=tags>
    <a class=tag>{ action.Type }</a>
  </nav>

  <address if={ 'address' in opts }>
    <a href="https://www.openstreetmap.org/?mlat={ actor.latitude }&mlon={ actor.longitude }#map=15/{ actor.latitude }/{ actor.longitude }&layers=T" target=_blank>
      { address[0] }<br>{ address[1] }
    </a>
  </address>

  <geo if={ action.distance }>{ actor.distance }km</geo>

  <script>
    this.action = opts.action
    this.actor = db.actors.find(actor => actor.Actions.includes(this.action.id))
    this.address = this.action['Adresse Postale'] && this.action['Adresse Postal'].split(',')
    this.maxlength = this.opts.maxlength || 80
  </script>

  <style scoped>
    :scope {
      display: grid;
      grid-template:
        "title        tags"
        "description  geo"
        / 1fr auto;
    }

    h3 {
      grid-area: title;
      font-size: 1.2em;
      margin-bottom: 1rem;
    }

    p {
      grid-area: description;
      margin: 0;
    }

    .tags {
      grid-area: tags;
      text-align: right;
    }

    geo {
      grid-area: geo;
      align-self: end;
      font-size: 1rem;
      text-align: right;
    }
    address {
      text-align: right;
    }
  </style>
</action-card>
